Improved version from Winform-4.8, using .NET 9.0 and decoupling
